# äº”ã€æ³›å‹

> ğŸ‘ <font color="red">staræœ¬é¡¹ç›®ç»™ä½œè€…ä¸€ç‚¹é¼“åŠ±å§</font>  

## 1.æ³›å‹ï¼ˆGenericsï¼‰

è®©æˆ‘ä»¬å¼€å§‹å†™ç¬¬ä¸€ä¸ªæ³›å‹ï¼Œä¸€ä¸ªæ’ç­‰å‡½æ•°ï¼ˆidentity functionï¼‰ã€‚æ‰€è°“æ’ç­‰å‡½æ•°ï¼Œå°±æ˜¯ä¸€ä¸ªè¿”å›ä»»ä½•ä¼ è¿›å†…å®¹çš„å‡½æ•°ã€‚

```ts
function identity(arg: number): number {
    return arg; // argæ˜¯numberç±»å‹ï¼Œè¿”å›å€¼åŒæ ·æ˜¯numberç±»å‹
}
```

æˆ‘ä»¬éœ€è¦ä¸€ç§å¯ä»¥æ•è·å‚æ•°ç±»å‹çš„æ–¹å¼ï¼Œç„¶åå†ç”¨å®ƒè¡¨ç¤ºè¿”å›å€¼çš„ç±»å‹ã€‚è¿™é‡Œæˆ‘ä»¬ç”¨äº†ä¸€ä¸ªç±»å‹å˜é‡ï¼ˆtype variableï¼‰ï¼Œä¸€ç§ç”¨åœ¨ç±»å‹è€Œéå€¼ä¸Šçš„ç‰¹æ®Šçš„å˜é‡ã€‚

```ts
function identity<Type>(arg: Type): Type {
    return arg;
}
```

ç°åœ¨æˆ‘ä»¬å·²ç»ç»™æ’ç­‰å‡½æ•°åŠ ä¸Šäº†ä¸€ä¸ªç±»å‹å˜é‡`Type`ï¼Œè¿™ä¸ª`Type`å…è®¸æˆ‘ä»¬æ•è·ç”¨æˆ·æä¾›çš„ç±»å‹ï¼Œä½¿å¾—æˆ‘ä»¬åœ¨æ¥ä¸‹æ¥å¯ä»¥ä½¿ç”¨è¿™ä¸ªç±»å‹ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬å†æ¬¡ç”¨`Type`ä½œä¸ºè¿”å›çš„å€¼çš„ç±»å‹ã€‚åœ¨ç°åœ¨çš„å†™æ³•é‡Œï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ¥šçš„çŸ¥é“å‚æ•°å’Œè¿”å›å€¼çš„ç±»å‹æ˜¯åŒä¸€ä¸ªã€‚

åœ¨æˆ‘ä»¬å†™äº†ä¸€ä¸ªæ³›å‹æ’ç­‰å‡½æ•°åï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹å¼å¯ä»¥è°ƒç”¨å®ƒã€‚ç¬¬ä¸€ç§æ–¹å¼æ˜¯ä¼ å…¥æ‰€æœ‰çš„å‚æ•°ï¼ŒåŒ…æ‹¬ç±»å‹å‚æ•°ï¼š

```ts
const identityString = identity<string> // const res: (arg: string) => string
```

ç¬¬äºŒç§æ–¹å¼å¯èƒ½æ›´å¸¸è§ä¸€äº›ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†ç±»å‹å‚æ•°æ¨æ–­ï¼ˆtype argument inferenceï¼‰æˆ‘ä»¬å¸Œæœ›ç¼–è¯‘å™¨èƒ½åŸºäºæˆ‘ä»¬ä¼ å…¥çš„å‚æ•°è‡ªåŠ¨æ¨æ–­å’Œè®¾ç½®`Type`çš„å€¼ã€‚

```ts
let strA = identity('isString'); // let strA: string
```

æ³¨æ„è¿™æ¬¡æˆ‘ä»¬å¹¶æ²¡æœ‰ç”¨`<Type>`æ˜ç¡®çš„ä¼ å…¥ç±»å‹ï¼Œå½“ç¼–è¯‘å™¨çœ‹åˆ°`isString`è¿™ä¸ªå€¼ï¼Œå°±ä¼šè‡ªåŠ¨è®¾ç½®`Type`ä¸ºå®ƒçš„ç±»å‹ï¼ˆå³ stringï¼‰ã€‚

ç±»å‹å‚æ•°æ¨æ–­æ˜¯ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„å·¥å…·ï¼Œå®ƒå¯ä»¥è®©æˆ‘ä»¬çš„ä»£ç æ›´çŸ­æ›´æ˜“é˜…è¯»ã€‚è€Œåœ¨ä¸€äº›æ›´åŠ å¤æ‚çš„ä¾‹å­ä¸­ï¼Œå½“ç¼–è¯‘å™¨æ¨æ–­ç±»å‹å¤±è´¥ï¼Œä½ æ‰éœ€è¦åƒä¸Šä¸€ä¸ªä¾‹å­ä¸­é‚£æ ·ï¼Œæ˜ç¡®çš„ä¼ å…¥å‚æ•°ã€‚

## 2.ä½¿ç”¨æ³›å‹ç±»å‹å˜é‡ï¼ˆWorking with Generic Type Variablesï¼‰

æˆ‘ä»¬åœ¨ä¸Šä¸€èŠ‚äº†è§£åˆ°çš„ä¾‹å­ä¸­ï¼ŒTypeæ˜¯ç›´æ¥ä½œä¸ºç±»å‹è¿›è¡Œä¼ é€’çš„ï¼Œè€Œåœ¨æŸäº›æ—¶å€™Typeä¹Ÿå¯ä»¥æ˜¯ç±»å‹çš„æŸä¸€ä¸ªå‚æ•°ï¼Œä¾‹å¦‚ï¼š

```ts
function loggingIdentity<Type>(arg: Type[]): Type[] {
    console.log(arg.length);
    console.log(arg[0]);
    return arg;
}
```

æ³›å‹å‡½æ•°`loggingIdentity`æ¥å—ä¸€ä¸ª Type ç±»å‹å‚æ•°å’Œä¸€ä¸ªå®å‚`arg`ï¼Œå®å‚`arg` æ˜¯ä¸€ä¸ª`Type`ç±»å‹çš„æ•°ç»„ã€‚è€Œè¯¥å‡½æ•°è¿”å›ä¸€ä¸ª`Type`ç±»å‹çš„æ•°ç»„ã€‚

ç°åœ¨æˆ‘ä»¬ä½¿ç”¨ç±»å‹å˜é‡ Typeï¼Œæ˜¯ä½œä¸ºæˆ‘ä»¬ä½¿ç”¨çš„ç±»å‹çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯ä¹‹å‰çš„ä¸€æ•´ä¸ªç±»å‹ï¼Œè¿™ä¼šç»™æˆ‘ä»¬æ›´å¤§çš„è‡ªç”±åº¦ã€‚

## 3.æ³›å‹ç±»å‹ (Generic Types)

æ³›å‹å‡½æ•°çš„å½¢å¼å°±è·Ÿå…¶ä»–éæ³›å‹å‡½æ•°çš„ä¸€æ ·ï¼Œéƒ½éœ€è¦å…ˆåˆ—ä¸€ä¸ªç±»å‹å‚æ•°åˆ—è¡¨ï¼Œè¿™æœ‰ç‚¹åƒå‡½æ•°å£°æ˜ï¼š

```ts
function identity<Type>(arg: Type): Type {
    console.log('>>:', arg);
    return arg;
}
let myIdentity: <T>(arg: T) => T = identity;
```

æ³¨æ„ï¼šä¸è¦å¯¹`<T>`æ„Ÿåˆ°ç–‘æƒ‘ï¼Œæ³›å‹çš„ç±»å‹å‚æ•°(Type || T || XX)å¯ä»¥ä½¿ç”¨ä¸åŒçš„åå­—ï¼Œåªè¦æ•°é‡å’Œä½¿ç”¨æ–¹å¼ä¸Šä¸€è‡´å³å¯ã€‚

æˆ‘ä»¬ä¹Ÿå¯ä»¥ä»¥å¯¹è±¡ç±»å‹çš„è°ƒç”¨ç­¾åçš„å½¢å¼ï¼Œä¹¦å†™è¿™ä¸ªæ³›å‹ç±»å‹ï¼š

```ts
function identity<Type>(arg: Type): Type {
    return arg;
}

let myIdentity: { <Type>(arg: Type): Type } = identity;
```

è¿™å¯ä»¥å¼•å¯¼æˆ‘ä»¬å†™å‡ºç¬¬ä¸€ä¸ªæ³›å‹æ¥å£ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ä¸Šä¸ªä¾‹å­ä¸­çš„å¯¹è±¡å­—é¢é‡ï¼Œç„¶åæŠŠå®ƒçš„ä»£ç ç§»åŠ¨åˆ°æ¥å£é‡Œï¼š

```ts
interface GenericIdentityFn {
    <Type>(arg: Type): Type;
}
 
function identity<Type>(arg: Type): Type {
    return arg;
}
 
let myIdentity: GenericIdentityFn = identity;
```


## 4.æ³›å‹ç±»ï¼ˆGeneric Classesï¼‰

**æ³›å‹ç±»**å†™æ³•ä¸Šç±»ä¼¼äº**æ³›å‹æ¥å£**ã€‚åœ¨ç±»ååé¢ï¼Œä½¿ç”¨å°–æ‹¬å·ä¸­ <> åŒ…è£¹ä½ç±»å‹å‚æ•°åˆ—è¡¨ï¼š

```ts
class GenericNumber<NumType> {
	zeroValue: NumType
	add: (x: NumType,) => NumType = x => x
	constructor(x: NumType) {
		this.zeroValue = x;
	}
}

const data = new GenericNumber(1);
data.add; // (property) GenericNumber<number>.add: (x: number) => number
```

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¹¶æ²¡æœ‰é™åˆ¶ä½ åªèƒ½ä½¿ç”¨`number`ç±»å‹ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–ç±»å‹ï¼š

```ts
type strOrNum = string | number;

class GenericNumber<NumType> {
	zeroValue: NumType
	add: (x: NumType,) => NumType = x => x
	constructor(x: NumType) {
		this.zeroValue = x;
	}
}

const data = new GenericNumber<strOrNum>(1);
data.add; // (property) GenericNumber<strOrNum>.add: (x: strOrNum) => strOrNum
```

å°±åƒæ¥å£ä¸€æ ·ï¼ŒæŠŠç±»å‹å‚æ•°æ”¾åœ¨ç±»ä¸Šï¼Œå¯ä»¥ç¡®ä¿ç±»ä¸­çš„æ‰€æœ‰å±æ€§éƒ½ä½¿ç”¨äº†ç›¸åŒçš„ç±»å‹ã€‚

## 5.æ³›å‹çº¦æŸï¼ˆGeneric Constraintsï¼‰

åœ¨æ—©ä¸€ç‚¹çš„ <a href="./3">ç¬¬ä¸‰ç« å‡½æ•°ä¸­</a> æˆ‘ä»¬æƒ³è¦è·å–å‚æ•°`obj.length` å±æ€§ï¼Œä½†æ˜¯ç¼–è¯‘å™¨å¹¶ä¸èƒ½è¯æ˜æ¯ç§ç±»å‹éƒ½æœ‰ `.length` å±æ€§ï¼Œç›¸æ¯”äºèƒ½å…¼å®¹ä»»ä½•ç±»å‹ï¼Œæˆ‘ä»¬æ›´æ„¿æ„çº¦æŸè¿™ä¸ªå‡½æ•°ï¼Œè®©å®ƒèƒ½ä½¿ç”¨å¸¦æœ‰`.length` å±æ€§çš„ç±»å‹ã€‚åªè¦ç±»å‹æœ‰è¿™ä¸ªæˆå‘˜ï¼Œæˆ‘ä»¬å°±å…è®¸ä½¿ç”¨å®ƒï¼Œä½†å¿…é¡»è‡³å°‘è¦æœ‰è¿™ä¸ªæˆå‘˜ã€‚

```ts
function longest<Type extends { length: number }>(a: Type, b: Type) {
    if (a.length >= b.length) {
        return a;
    } else {
        return b;
    }
}
```

æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ—å‡ºå¯¹ Type çº¦æŸä¸­çš„å¿…è¦æ¡ä»¶ï¼Œä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªæ¥å£ï¼Œç”¨æ¥æè¿°çº¦æŸã€‚è¿™é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåªæœ‰ .length å±æ€§çš„æ¥å£ï¼Œç„¶åæˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªæ¥å£å’Œ extendå…³é”®è¯å®ç°äº†çº¦æŸï¼š

```ts
interface Lengthwise {
  length: number;
}
function longest<Type extends Lengthwise>(a: Type, b: Type) {
    if (a.length >= b.length) {
        return a;
    } else {
        return b;
    }
}
```

### 5.1 åœ¨æ³›å‹çº¦æŸä¸­ä½¿ç”¨ç±»å‹å‚æ•°ï¼ˆUsing Type Parameters in Generic Constraintsï¼‰

ä½ å¯ä»¥å£°æ˜ä¸€ä¸ªç±»å‹å‚æ•°ï¼Œè¿™ä¸ªç±»å‹å‚æ•°è¢«å…¶ä»–ç±»å‹å‚æ•°çº¦æŸã€‚

ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¸Œæœ›è·å–åçš„å€¼ï¼Œä¸€ä¸ªå¯¹è±¡ç»™å®šå±æ€§ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿æˆ‘ä»¬ä¸ä¼šè·å–`obj`ä¸Šä¸å­˜åœ¨çš„å±æ€§ã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨ä¸¤ä¸ªç±»å‹ä¹‹é—´å»ºç«‹ä¸€ä¸ªçº¦æŸï¼š

```ts
function getProperty<Type, Key extends keyof Type>(obj: Type, key: Key) {
    return obj[key];
}

let x = { a: 1, b: 2, c: 3, d: 4 };

getProperty(x, "a");
getProperty(x, "m");
// ç±»å‹â€œ"m"â€çš„å‚æ•°ä¸èƒ½èµ‹ç»™ç±»å‹â€œ"a" | "b" | "c" | "d"â€çš„å‚æ•°ã€‚
```

### 5.2 åœ¨æ³›å‹ä¸­ä½¿ç”¨ç±»ç±»å‹ï¼ˆUsing Class Types in Genericsï¼‰

åœ¨ TypeScript ä¸­ï¼Œå½“ä½¿ç”¨å·¥å‚æ¨¡å¼åˆ›å»ºå®ä¾‹çš„æ—¶å€™ï¼Œæœ‰å¿…è¦é€šè¿‡ä»–ä»¬çš„æ„é€ å‡½æ•°æ¨æ–­å‡ºç±»çš„ç±»å‹ï¼Œä¸¾ä¸ªä¾‹å­ï¼š

```ts
function create<Type>(c: { new (): Type }): Type {
    return new c();
}

class BeeKeeper {
    hasMask: boolean = true;
}

class ZooKeeper {
    nametag: string = "Mikle";
}

class Animal {
    numLegs: number = 4;
}

class Bee extends Animal {
    keeper: BeeKeeper = new BeeKeeper();
}

class Lion extends Animal {
    keeper: ZooKeeper = new ZooKeeper();
}

function createInstance<A extends Animal>(c: new () => A): A {
    return new c();
}

createInstance(Lion).keeper.nametag;
createInstance(Bee).keeper.hasMask;
```

## å†™åœ¨æœ€å

**å‚è€ƒï¼š**

* [TypeScriptæ–‡æ¡£](https://www.typescriptlang.org/docs/handbook/2/objects.html)
* [TypeScript4ä¸­æ–‡æ–‡æ¡£](https://mqyqingfeng.github.io/learn-typescript/handbook/Generics.html#%E6%B3%9B%E5%9E%8B-generics)

**æ¬¢è¿Starâ­ï¸**

* [Jsç‰ˆLeetCodeé¢˜è§£](https://webbj97.github.io/leetCode-Js/)
* [ä½™å…‰çš„å‰ç«¯æˆé•¿ç¬”è®°](https://github.com/webbj97/summary)
* [é«˜é¢‘æ‰‹æ’•ä»£ç ç³»åˆ—](https://github.com/webbj97/fe-questions) 

<p align=center>
	<img src="https://hlgcdn.oss-cn-hangzhou.aliyuncs.com/hlg-ui/1607504321645897/yuguang-vue-bottom.gif" width="100%"/>
</p>


